<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>rTensor2</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">rTensor2</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(rTensor)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(rTensor2)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co">#&gt; The legacy packages maptools, rgdal, and rgeos, underpinning the sp package,</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co">#&gt; which was just loaded, were retired in October 2023.</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co">#&gt; Please refer to R-spatial evolution reports for details, especially</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co">#&gt; https://r-spatial.org/r/2023/05/15/evolution4.html.</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co">#&gt; It may be desirable to make the sf package available;</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co">#&gt; package maintainers should consider adding sf to Suggests:.</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;rTensor2&#39;</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:rTensor&#39;:</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="co">#&gt;     as.tensor, rand_tensor</span></span></code></pre></div>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>rTensor2 is a set of tools to manipulate 3D tensors of data. The
package follows the work of Kernfled et al. (2015) <a href="https://www.sciencedirect.com/science/article/pii/S0024379515004358" class="uri">https://www.sciencedirect.com/science/article/pii/S0024379515004358</a>.
For most operations, the first step is to take a discrete linear
transpose along mode 3. The rTensor2 package extends the work of the
rTensor package <a href="https://www.jstatsoft.org/article/download/v087i10/1270" class="uri">https://www.jstatsoft.org/article/download/v087i10/1270</a>
which also provides 3D tensor tools, but this work was based on the
discrete Fourier transform. rTensor2 however, extends this package by
allowing tensor manipulation to be done using any one of six discrete
transforms.</p>
<p>General principles:</p>
<ul>
<li><p>Results are transformation dependent. In other words, multiplying
2 tensors together using a different transformation will give you a
different product.</p></li>
<li><p>Inverses are not unique. In other words, different
transformations yield inverses that are scaled differently. When
calculating: <span class="math inline">\(\texttt{tmult}(\texttt{A},\texttt{tInv(A)},\texttt{&quot;tform&quot;})=\texttt{I}\)</span>,
the identity tensor will have zeros for all lateral slices except the
first slice and the first lateral slice will be an identity matrix times
some scalar. The scalar will be different depending on which transform
was used as well as the number of lateral slices.</p></li>
<li><p>If you calculate the inverse tensor and then use the inverse
tensor in a product, you must use the same transformation that was used
to find the inverse tensor. The same is true for the tensor transpose
function.</p></li>
</ul>
</div>
<div id="tensor-multiplication" class="section level2">
<h2>Tensor Multiplication</h2>
<p>The tensor multiplication function (<span class="math inline">\(\texttt{tmult}\)</span>) multiplies two tensors.
Step one is to perform a discrete transform along mode 3. After
transformation, the frontal slices are multiplied to together resulting
in a new tensor.</p>
<p>Because the frontal faces are multiplied together, the second mode of
the first tensor must match the first mode of the second tensor. As a
example, we can multiply a <span class="math inline">\(3 \times 4 \times
2\)</span> tensor by a <span class="math inline">\(4 \times 5 \times
2\)</span> tensor. In addition, mode 3 dimensions must also match. If
you are using the discrete wavelet transform, there is an additional
requirement that the mode 3 dimension must be a of length <span class="math inline">\(2^n\)</span> where <span class="math inline">\(n&gt;1\)</span> otherwise you must 0 pad the
tensor in that dimension.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">rand_tensor</span>(<span class="at">modes=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>))</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">rand_tensor</span>(<span class="at">modes=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">2</span>))</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">tmult</span>(<span class="at">x=</span>A,<span class="at">y=</span>B,<span class="st">&quot;dct&quot;</span>)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co">#&gt; Numeric Tensor of 3 Modes</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt; Modes:  3 5 2 </span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt; Data: </span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt; , , 1</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#&gt;            [,1]       [,2]       [,3]       [,4]        [,5]</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co">#&gt; [1,]  1.6133154 1.77932895  0.7206821 -0.1622463  1.36168591</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="co">#&gt; [2,] -0.2629096 0.50051441 -2.5829045 -0.4363478  3.73739424</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co">#&gt; [3,]  2.2205579 0.03118077 -1.7549949 -0.9282181 -0.08587165</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="co">#&gt; , , 2</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co">#&gt;            [,1]       [,2]      [,3]      [,4]       [,5]</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="co">#&gt; [1,]  1.0398736 -0.7913833 0.6474074  1.128169 -1.2893098</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="co">#&gt; [2,] -0.6216461 -2.4246046 1.2147955 -1.279326 -2.8270854</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="co">#&gt; [3,] -2.1828371 -0.7887816 1.9263148 -1.420152 -0.9607526</span></span></code></pre></div>
</div>
<div id="tensor-inverse" class="section level2">
<h2>Tensor Inverse</h2>
<p>The tensor inverse function (<span class="math inline">\(\texttt{tINV}\)</span>) performs a discrete
transformation down mode 3. Then, each of the frontal slices are
inverted. Because the slices must be inverted, the mode 1 and mode 2
dimensions must be equal.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>A <span class="ot">&lt;-</span>  <span class="fu">rand_tensor</span>(<span class="at">modes=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>))</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>Ainv <span class="ot">=</span> <span class="fu">tINV</span>(A,<span class="st">&quot;dct&quot;</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="fu">tmult</span>(A,Ainv,<span class="st">&quot;dct&quot;</span>) <span class="co"># the result is an identity tensor</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; Numeric Tensor of 3 Modes</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; Modes:  3 3 2 </span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; Data: </span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; , , 1</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt;               [,1]         [,2]          [,3]</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt; [1,]  1.414214e+00 2.854992e-16 -1.275700e-16</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt; [2,] -7.850462e-17 1.414214e+00  2.551400e-16</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co">#&gt; [3,]  5.887847e-17 3.025571e-16  1.414214e+00</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="co">#&gt; , , 2</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="co">#&gt;               [,1]          [,2]          [,3]</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="co">#&gt; [1,]  0.000000e+00  4.814541e-17  2.943923e-17</span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a><span class="co">#&gt; [2,]  0.000000e+00  3.330669e-16  1.373831e-16</span></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a><span class="co">#&gt; [3,] -2.158877e-16 -1.455479e-16 -1.110223e-16</span></span></code></pre></div>
</div>
<div id="tensor-transpose" class="section level2">
<h2>Tensor Transpose</h2>
<p>The tensor transpose (<span class="math inline">\(\texttt{t_tpose}\)</span>) performs a discrete
transformation down mode 3. Then, each of the frontal slices are
transposed.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>A <span class="ot">&lt;-</span>  <span class="fu">rand_tensor</span>(<span class="at">modes=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">2</span>))</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>A</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt; Numeric Tensor of 3 Modes</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; Modes:  3 5 2 </span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; Data: </span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; , , 1</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt;             [,1]      [,2]      [,3]      [,4]       [,5]</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt; [1,]  0.49048141 0.4477505 -1.033263  0.721805 -0.5188771</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt; [2,]  0.02051673 0.7350448 -1.122336  2.841532  0.1427587</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#&gt; [3,] -0.19998115 0.9877364 -1.698322 -2.033514 -1.4707067</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt; , , 2</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#&gt;            [,1]        [,2]       [,3]       [,4]       [,5]</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="co">#&gt; [1,]  0.6229412 -0.01278372 -1.3598823 -1.6762711 -0.7046493</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co">#&gt; [2,] -0.3639559 -1.17917665 -0.1584992 -2.1216170 -0.1896852</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="co">#&gt; [3,] -1.9480121  2.26426156 -0.3665493 -0.7474772  0.5891663</span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a><span class="fu">t_tpose</span>(A,<span class="st">&quot;dct&quot;</span>)</span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="co">#&gt; Numeric Tensor of 3 Modes</span></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a><span class="co">#&gt; Modes:  5 3 2 </span></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a><span class="co">#&gt; Data: </span></span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a><span class="co">#&gt; , , 1</span></span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a><span class="co">#&gt;            [,1]        [,2]       [,3]</span></span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a><span class="co">#&gt; [1,]  0.4904814  0.02051673 -0.1999811</span></span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a><span class="co">#&gt; [2,]  0.4477505  0.73504478  0.9877364</span></span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a><span class="co">#&gt; [3,] -1.0332634 -1.12233571 -1.6983223</span></span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a><span class="co">#&gt; [4,]  0.7218050  2.84153248 -2.0335139</span></span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a><span class="co">#&gt; [5,] -0.5188771  0.14275871 -1.4707067</span></span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-32"><a href="#cb4-32" tabindex="-1"></a><span class="co">#&gt; , , 2</span></span>
<span id="cb4-33"><a href="#cb4-33" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-34"><a href="#cb4-34" tabindex="-1"></a><span class="co">#&gt;             [,1]       [,2]       [,3]</span></span>
<span id="cb4-35"><a href="#cb4-35" tabindex="-1"></a><span class="co">#&gt; [1,]  0.62294115 -0.3639559 -1.9480121</span></span>
<span id="cb4-36"><a href="#cb4-36" tabindex="-1"></a><span class="co">#&gt; [2,] -0.01278372 -1.1791767  2.2642616</span></span>
<span id="cb4-37"><a href="#cb4-37" tabindex="-1"></a><span class="co">#&gt; [3,] -1.35988232 -0.1584992 -0.3665493</span></span>
<span id="cb4-38"><a href="#cb4-38" tabindex="-1"></a><span class="co">#&gt; [4,] -1.67627113 -2.1216170 -0.7474772</span></span>
<span id="cb4-39"><a href="#cb4-39" tabindex="-1"></a><span class="co">#&gt; [5,] -0.70464929 -0.1896852  0.5891663</span></span></code></pre></div>
</div>
<div id="eigenvalue-decomposition" class="section level2">
<h2>Eigenvalue Decomposition</h2>
<p>The eigenvalue decomposition function (<span class="math inline">\(\texttt{tEIG}\)</span>) performs an eigenvalue
decomposition on a tensor whose dimensions are <span class="math inline">\(n \times n \times k\)</span> using any discrete
transform. The function returns 2 tenors, an <span class="math inline">\(n \times n \times k\)</span> tensor of
eigenvectors and a diagonal tensor of eigenvalues which is also <span class="math inline">\(n \times n \times k\)</span>. Notice that if we
multiply <span class="math inline">\(P D P^{-1}\)</span> we obtain the
original tensor.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>A <span class="ot">=</span> <span class="fu">rand_tensor</span>(<span class="at">modes=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>))</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>result <span class="ot">=</span> <span class="fu">tEIG</span>(A,<span class="st">&quot;dst&quot;</span>)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>A <span class="sc">-</span> <span class="fu">tmult</span>(<span class="fu">tmult</span>(result<span class="sc">$</span>P,result<span class="sc">$</span>D,<span class="st">&quot;dst&quot;</span>),<span class="fu">tINV</span>(result<span class="sc">$</span>P,<span class="st">&quot;dst&quot;</span>),<span class="st">&quot;dst&quot;</span>) <span class="co"># zero tensor</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; Numeric Tensor of 3 Modes</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt; Modes:  3 3 2 </span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt; Data: </span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt; , , 1</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt;                             [,1]                        [,2]</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt; [1,] -5.551115e-16-2.220446e-16i  2.775558e-17-1.665335e-16i</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#&gt; [2,] -8.881784e-16+1.480297e-16i -1.776357e-15+2.220446e-16i</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt; [3,] -4.440892e-16+3.700743e-16i  9.992007e-16-2.960595e-16i</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt;                            [,3]</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co">#&gt; [1,] 2.220446e-16+1.480297e-16i</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">#&gt; [2,] 6.661338e-16+7.401487e-17i</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="co">#&gt; [3,] 0.000000e+00-1.480297e-16i</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="co">#&gt; , , 2</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a><span class="co">#&gt;                             [,1]                        [,2]</span></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a><span class="co">#&gt; [1,] -1.332268e-15+3.798274e-16i  6.661338e-16-9.850178e-17i</span></span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a><span class="co">#&gt; [2,]  1.221245e-15-2.880519e-16i -2.220446e-16-1.253066e-16i</span></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a><span class="co">#&gt; [3,]  2.359224e-16-1.683961e-16i  8.881784e-16-1.147800e-16i</span></span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a><span class="co">#&gt;                            [,3]</span></span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a><span class="co">#&gt; [1,] -8.881784e-16-6.05406e-17i</span></span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a><span class="co">#&gt; [2,] -1.998401e-15+1.98069e-16i</span></span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a><span class="co">#&gt; [3,]  1.443290e-15-3.40565e-16i</span></span></code></pre></div>
</div>
<div id="lu-decomposition" class="section level2">
<h2>LU Decomposition</h2>
<p>The LU decomposition factors a 3-mode tensor into a lower triangular
tensor and an upper triangular tensor.</p>
<p>Note: In order to perform this operation, the frontal slices need to
be square.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">rand_tensor</span>(<span class="at">modes=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>))</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">tLU</span>(A,<span class="st">&quot;dht&quot;</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>A <span class="sc">-</span> <span class="fu">tmult</span>(result<span class="sc">$</span>L,result<span class="sc">$</span>U,<span class="st">&quot;dht&quot;</span>)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt; Numeric Tensor of 3 Modes</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#&gt; Modes:  3 3 2 </span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt; Data: </span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt; , , 1</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt;               [,1] [,2]         [,3]</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#&gt; [1,]  0.000000e+00    0 1.110223e-16</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co">#&gt; [2,] -1.110223e-16    0 0.000000e+00</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co">#&gt; [3,] -1.110223e-16    0 0.000000e+00</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="co">#&gt; , , 2</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="co">#&gt;              [,1]          [,2]          [,3]</span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="co">#&gt; [1,] 0.000000e+00 -5.551115e-17  0.000000e+00</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="co">#&gt; [2,] 0.000000e+00  0.000000e+00  0.000000e+00</span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="co">#&gt; [3,] 8.326673e-17 -3.885781e-16 -1.110223e-16</span></span></code></pre></div>
</div>
<div id="qr-decomposition" class="section level2">
<h2>QR Decomposition</h2>
<p>The QR decomposition factors a 3-mode tensor into a left singular
tensor object tensor and a right singular tensor object.</p>
<p>Note: In order to perform this operation, the frontal slices need to
be square.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">rand_tensor</span>(<span class="at">modes=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>))</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">tQR</span>(A,<span class="st">&quot;fft&quot;</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>A <span class="sc">-</span> <span class="fu">tmult</span>(result<span class="sc">$</span>Q,result<span class="sc">$</span>R,<span class="st">&quot;fft&quot;</span>)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt; Numeric Tensor of 3 Modes</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt; Modes:  3 3 2 </span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; Data: </span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; , , 1</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt;              [,1]          [,2]         [,3]</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt; [1,] 5.551115e-17  4.440892e-16 0.000000e+00</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">#&gt; [2,] 0.000000e+00 -1.387779e-17 2.220446e-16</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt; [3,] 0.000000e+00  5.551115e-17 2.220446e-16</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co">#&gt; , , 2</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="co">#&gt;               [,1]         [,2]         [,3]</span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="co">#&gt; [1,]  0.000000e+00 1.665335e-16 0.000000e+00</span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="co">#&gt; [2,]  5.551115e-17 0.000000e+00 0.000000e+00</span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a><span class="co">#&gt; [3,] -2.775558e-17 0.000000e+00 2.220446e-16</span></span></code></pre></div>
</div>
<div id="singular-value-decomposition" class="section level2">
<h2>Singular Value Decomposition</h2>
<p>As an example, we use singular value decomposition (SVD) for image
compression. By factoring a tensor <span class="math inline">\(\cal{A}\)</span> into orthogonal tensors <span class="math inline">\(\cal{U},\cal{S}\)</span> and <span class="math inline">\(\cal{V}\)</span>} using the SVD, we can then
truncate the tensor to the first <span class="math inline">\(k\)</span>
singular values and compare different transforms to the original
image.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co">#&gt; Loading required package: sp</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="fu">data</span>(raytrace)</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>tform <span class="ot">=</span> <span class="st">&quot;dst&quot;</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>A <span class="ot">=</span> raytrace<span class="sc">$</span>boat</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>wSVD <span class="ot">=</span> <span class="fu">tSVD</span>(A,tform)</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>k <span class="ot">=</span> <span class="dv">30</span> <span class="co"># number of singular values kept</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>U <span class="ot">=</span> wSVD<span class="sc">$</span>U</span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>V <span class="ot">=</span> wSVD<span class="sc">$</span>V</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>S <span class="ot">=</span> wSVD<span class="sc">$</span>S</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>tV <span class="ot">=</span> <span class="fu">t_tpose</span>(V,tform)</span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a>Uk <span class="ot">=</span> <span class="fu">rand_tensor</span>(<span class="at">modes =</span> <span class="fu">c</span>(<span class="dv">128</span>, k, <span class="dv">128</span>), <span class="at">drop =</span> <span class="cn">FALSE</span>)<span class="sc">*</span><span class="dv">0</span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a>Sk <span class="ot">=</span> <span class="fu">rand_tensor</span>(<span class="at">modes =</span> <span class="fu">c</span>(k, k, <span class="dv">128</span>), <span class="at">drop =</span> <span class="cn">FALSE</span>)<span class="sc">*</span><span class="dv">0</span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a>Vk <span class="ot">=</span> <span class="fu">rand_tensor</span>(<span class="at">modes =</span> <span class="fu">c</span>(k, <span class="dv">128</span>, <span class="dv">128</span>), <span class="at">drop =</span> <span class="cn">FALSE</span>)<span class="sc">*</span><span class="dv">0</span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a>Uk <span class="ot">=</span> U[,<span class="dv">1</span><span class="sc">:</span>k,]<span class="sc">@</span>data</span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a></span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a>Sk <span class="ot">=</span> S[<span class="dv">1</span><span class="sc">:</span>k,<span class="dv">1</span><span class="sc">:</span>k,]<span class="sc">@</span>data</span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a></span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a>Vk <span class="ot">=</span> tV[<span class="dv">1</span><span class="sc">:</span>k,,]<span class="sc">@</span>data</span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a></span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a>Uk <span class="ot">=</span> <span class="fu">as.tensor</span>(Uk)</span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a>Vk <span class="ot">=</span> <span class="fu">as.tensor</span>(Vk)</span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a>Sk <span class="ot">=</span> <span class="fu">as.tensor</span>(Sk)</span>
<span id="cb8-30"><a href="#cb8-30" tabindex="-1"></a></span>
<span id="cb8-31"><a href="#cb8-31" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">tmult</span>(Uk, Sk,tform)</span>
<span id="cb8-32"><a href="#cb8-32" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">tmult</span>(X, Vk, tform)</span>
<span id="cb8-33"><a href="#cb8-33" tabindex="-1"></a></span>
<span id="cb8-34"><a href="#cb8-34" tabindex="-1"></a><span class="co"># See how close the compressed image is to the original image</span></span>
<span id="cb8-35"><a href="#cb8-35" tabindex="-1"></a><span class="fu">fnorm</span>(X<span class="sc">-</span>A)</span>
<span id="cb8-36"><a href="#cb8-36" tabindex="-1"></a><span class="co">#&gt; [1] 15.6157</span></span>
<span id="cb8-37"><a href="#cb8-37" tabindex="-1"></a></span>
<span id="cb8-38"><a href="#cb8-38" tabindex="-1"></a><span class="co"># feature scale</span></span>
<span id="cb8-39"><a href="#cb8-39" tabindex="-1"></a><span class="cf">if</span> (tform<span class="sc">==</span><span class="st">&quot;fft&quot;</span>){</span>
<span id="cb8-40"><a href="#cb8-40" tabindex="-1"></a>  Xnew<span class="ot">=</span><span class="fu">Re</span>(X<span class="sc">@</span>data)</span>
<span id="cb8-41"><a href="#cb8-41" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb8-42"><a href="#cb8-42" tabindex="-1"></a>  Xnew <span class="ot">=</span> X<span class="sc">@</span>data</span>
<span id="cb8-43"><a href="#cb8-43" tabindex="-1"></a>}</span>
<span id="cb8-44"><a href="#cb8-44" tabindex="-1"></a>Xnew <span class="ot">=</span> X<span class="sc">@</span>data</span>
<span id="cb8-45"><a href="#cb8-45" tabindex="-1"></a>newX <span class="ot">=</span> (Xnew<span class="sc">-</span><span class="fu">min</span>(Xnew))<span class="sc">/</span>(<span class="fu">max</span>(Xnew)<span class="sc">-</span><span class="fu">min</span>(Xnew))</span>
<span id="cb8-46"><a href="#cb8-46" tabindex="-1"></a></span>
<span id="cb8-47"><a href="#cb8-47" tabindex="-1"></a><span class="co"># View Images</span></span>
<span id="cb8-48"><a href="#cb8-48" tabindex="-1"></a></span>
<span id="cb8-49"><a href="#cb8-49" tabindex="-1"></a><span class="co"># Compressed image</span></span>
<span id="cb8-50"><a href="#cb8-50" tabindex="-1"></a><span class="co"># grid.raster(newX[,45,])</span></span>
<span id="cb8-51"><a href="#cb8-51" tabindex="-1"></a><span class="co"># title(paste0(&#39;Compressed&#39;))</span></span>
<span id="cb8-52"><a href="#cb8-52" tabindex="-1"></a><span class="co"># Original Image</span></span>
<span id="cb8-53"><a href="#cb8-53" tabindex="-1"></a><span class="co"># grid.raster(XT[,45,]@data)</span></span></code></pre></div>
</div>
<div id="linear-discriminate-analysis" class="section level2">
<h2>Linear Discriminate Analysis</h2>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
